<!-- app/views/student/forms/show.html.erb -->

<div class="page-wrapper">

  <!-- HERO -->
  <section class="hero d-flex align-items-center">
    <div class="container">
      <div class="hero-content">

        <h1 class="hero-title"><%= @form.title %></h1>
        <p class="hero-subtitle"><%= @form.klass.name %></p>

        <%= link_to 'Voltar', root_path, class: 'hero-back-btn' %>

      </div>
    </div>
  </section>


  <!-- MAIN CONTENT -->
  <section class="container content-section">

    <!-- INFO CARD -->
    <div class="info-card shadow-layer">
      <h2 class="section-title">Informações</h2>

      <div class="info-grid">
        <div class="info-block">
          <p class="info-label">Descrição</p>
          <p class="info-value"><%= @form.description.presence || "—" %></p>
        </div>

        <div class="info-block">
          <p class="info-label">Prazo</p>
          <p class="info-value">
            <% if @form.due_date.present? %>
              <%= l(@form.due_date, format: :long) %>
            <% else %>
              Sem prazo
            <% end %>
          </p>
        </div>
      </div>
    </div>


    <!-- RESPONSES -->
    <% if @form_response&.completed? %>

      <div class="status-card completed shadow-layer">
        <div class="status-icon">✓</div>

        <div>
          <h3 class="status-title">Formulário respondido</h3>
          <p class="status-date"><%= l(@form_response.submitted_at, format: :long) %></p>
        </div>
      </div>

      <div class="responses-card shadow-layer">
        <h3 class="section-title">Suas Respostas</h3>

        <div class="table-responsive">
          <table class="modern-table">
            <thead>
              <tr>
                <th>Pergunta</th>
                <th>Resposta</th>
              </tr>
            </thead>

            <tbody>
              <% @form_response.form_answers.each do |answer| %>
                <tr>
                  <td class="question"><%= answer.form_template_field.label %></td>
                  <td class="answer"><%= answer.answer.presence || "—" %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>

    <% else %>

      <div class="status-card pending shadow-layer">
        <div class="status-icon">!</div>

        <div>
          <h3 class="status-title">Formulário pendente</h3>
          <p class="status-date">Você ainda não respondeu este formulário.</p>
        </div>

        <%= link_to 'Responder agora',
                    answer_student_form_path(@form),
                    class: 'primary-action-btn' %>
      </div>

    <% end %>

  </section>

</div>
