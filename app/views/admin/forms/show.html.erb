<!-- app/views/admin/forms/show.html.erb -->

<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1><%= @form.title %></h1>
      <p class="text-muted">
        Turma: <strong><%= @form.klass.name %></strong> | 
        Template: <strong><%= @form.form_template.name %></strong>
      </p>
    </div>
    <div class="d-flex gap-2">
      <%= link_to 'Voltar', admin_forms_path, class: 'btn btn-secondary' %>
      <% if @form.draft? %>
        <%= button_to 'Publicar', publish_admin_form_path(@form), method: :patch, class: 'btn btn-success' %>
      <% elsif @form.published? %>
        <%= button_to 'Fechar', close_admin_form_path(@form), method: :patch, class: 'btn btn-danger' %>
      <% end %>
    </div>
  </div>

  <!-- Restante do conteúdo da página -->
  <h3 class="mt-5">Respostas</h3>
  <div class="table-responsive">
    <table class="table table-sm">
      <thead class="table-light">
        <tr>
          <th>Aluno</th>
          <th>Status</th>
          <th>Respondido em</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <% @form.form_responses.each do |response| %>
          <tr>
            <td><%= response.user.name %></td>
            <td>
              <% if response.completed? %>
                <span class="badge bg-success">Respondido</span>
              <% else %>
                <span class="badge bg-warning">Pendente</span>
              <% end %>
            </td>
            <td><%= response.submitted_at.present? ? l(response.submitted_at, format: :short) : '-' %></td>
            <td>
              <% if response.completed? %>
                <%= link_to 'Ver Respostas', view_response_admin_form_path(@form, response_id: response.id), class: 'btn btn-sm btn-info' %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="mt-4">
    <%= link_to 'Voltar', admin_forms_path, class: 'btn btn-secondary' %>
  </div>
</div>
