<!-- app/views/admin/form_templates/edit.html.erb -->

<div class="container py-5">

  <div class="row justify-content-center">
    <div class="col-lg-9">

      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h1 class="fw-bold mb-1 text-primary">Editar Template</h1>
          <p class="text-muted">Gerencie os campos e informações deste template.</p>
        </div>
        <%= link_to 'Cancelar', admin_form_templates_path, class: 'btn btn-outline-secondary' %>
      </div>


      <!-- Main Form Card -->
      <div class="card shadow-sm border-0 rounded-4 mb-5">
        <div class="card-body p-4">

          <%= form_with(model: [:admin, @form_template], local: true) do |form| %>

            <!-- Errors -->
            <% if @form_template.errors.any? %>
              <div class="alert alert-danger rounded-3 py-3 px-4 mb-4">
                <h5 class="fw-bold mb-2">
                  <%= pluralize(@form_template.errors.count, "erro") %> encontrado(s):
                </h5>
                <ul class="mb-0">
                  <% @form_template.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                  <% end %>
                </ul>
              </div>
            <% end %>

            <!-- Template Information -->
            <h4 class="fw-semibold text-primary mb-3">Informações do Template</h4>

            <div class="mb-4">
              <%= form.label :name, "Nome do Template", class: "form-label fw-semibold" %>
              <%= form.text_field :name, class: "form-control form-control-lg", placeholder: "Ex: Avaliação Final" %>
            </div>

            <div class="mb-4">
              <%= form.label :description, "Descrição", class: "form-label fw-semibold" %>
              <%= form.text_area :description, class: "form-control", rows: 3, placeholder: "Breve descrição do propósito deste template..." %>
            </div>

            <hr class="my-4">

            <!-- Fields Section -->
            <h4 class="fw-semibold text-primary mb-3">Campos do Template</h4>

            <div id="fields-container" class="mb-4">
              <%= form.fields_for :form_template_fields do |field_form| %>
                <%= render 'form_template_field_form', f: field_form %>
              <% end %>
            </div>

            <!-- Add Field Button -->
            <div class="d-flex justify-content-start mb-4">
              <%= link_to_add_fields "➕ Adicionar Campo",
                  form,
                  :form_template_fields,
                  class: "btn btn-outline-primary btn-lg rounded-3" %>
            </div>

            <!-- Actions -->
            <div class="d-flex gap-3">
              <%= form.submit "Salvar Alterações",
                  class: "btn btn-success btn-lg px-4 rounded-3" %>

              <%= link_to 'Cancelar',
                  admin_form_templates_path,
                  class: "btn btn-secondary btn-lg px-4 rounded-3" %>
            </div>

          <% end %>

        </div>
      </div>

    </div>
  </div>

</div>
